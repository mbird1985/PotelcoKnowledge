{% extends "base.html" %}
{% block content %}
<div class="space-y-6">
  <h2 class="text-2xl font-semibold text-teal-800">Equipment</h2>

  {% with messages = get_flashed_messages() %}
    {% if messages %}
      <p class="text-orange-500 text-center">{{ messages[0] }}</p>
    {% endif %}
  {% endwith %}

  {% if can_edit %}
  <div class="bg-white p-6 rounded-lg shadow-md">
    <h3 class="text-xl font-semibold text-teal-800 mb-4">Add New Equipment</h3>
    <form method="POST" class="space-y-4">
      <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
        <div>
          <label class="block text-teal-800 font-medium">Equipment ID:</label>
          <input type="text" name="equipment_id" required class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
        </div>
        <div>
          <label class="block text-teal-800 font-medium">Type:</label>
          <input type="text" name="type" required class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
        </div>
        <div>
          <label class="block text-teal-800 font-medium">Brand:</label>
          <input type="text" name="brand" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
        </div>
        <div>
          <label class="block text-teal-800 font-medium">Model:</label>
          <input type="text" name="model" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
        </div>
        <div>
          <label class="block text-teal-800 font-medium">Serial Number:</label>
          <input type="text" name="serial_number" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
        </div>
        <div>
          <label class="block text-teal-800 font-medium">Hours/Mileage:</label>
          <input type="number" step="0.1" name="hours_mileage" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
        </div>
        <div>
          <label class="block text-teal-800 font-medium">Fuel Type:</label>
          <input type="text" name="fuel_type" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
        </div>
        <div>
          <label class="block text-teal-800 font-medium">Gross Weight:</label>
          <input type="number" step="0.1" name="gross_weight" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
        </div>
        <div>
          <label class="flex items-center text-teal-800 font-medium">
            <input type="checkbox" name="requires_operator" class="mr-2"> Requires Operator
          </label>
        </div>
        <div>
          <label class="block text-teal-800 font-medium">Last Maintenance:</label>
          <input type="date" name="last_maintenance" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
        </div>
        <div>
          <label class="block text-teal-800 font-medium">Maintenance Threshold:</label>
          <input type="number" step="0.1" name="maintenance_threshold" class="w-full p-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-teal-500">
        </div>
      </div>
      <div class="mt-4 flex justify-center">
        <button type="submit" name="add_equipment" class="bg-teal-500 text-white px-4 py-2 rounded-lg hover:bg-teal-600">Add Equipment</button>
      </div>
    </form>
  </div>
  {% endif %}

  <div class="flex space-x-4 mb-4">
    <a href="/equipment" class="bg-teal-500 text-white px-4 py-2 rounded-lg hover:bg-teal-600">Show All</a>
    <a href="/equipment?available_only=true" class="bg-gray-500 text-white px-4 py-2 rounded-lg hover:bg-gray-600">Show Available Only</a>
  </div>

  <div class="bg-white p-6 rounded-lg shadow-md">
    <table class="w-full border-collapse">
      <thead class="bg-teal-800 text-white">
        <tr>
          <th class="p-3 text-left">Equipment ID</th>
          <th class="p-3 text-left">Type</th>
          <th class="p-3 text-left">Brand</th>
          <th class="p-3 text-left">Model</th>
          <th class="p-3 text-left">Serial Number</th>
          <th class="p-3 text-left">Hours/Mileage</th>
          <th class="p-3 text-left">Fuel Type</th>
          <th class="p-3 text-left">Gross Weight</th>
          <th class="p-3 text-left">Requires Operator</th>
          <th class="p-3 text-left">Last Maintenance</th>
          <th class="p-3 text-left">Status</th>
          <th class="p-3 text-left">Details</th>
          {% if can_edit %}
          <th class="p-3 text-left">Delete</th>
          {% endif %}
        </tr>
      </thead>
      <tbody>
        {% for equip in equipment %}
        <tr class="border-b hover:bg-gray-50">
          <td class="p-3">{{ equip.equipment_id }}</td>
          <td class="p-3">{{ equip.type }}</td>
          <td class="p-3">{{ equip.brand }}</td>
          <td class="p-3">{{ equip.model }}</td>
          <td class="p-3">{{ equip.serial_number }}</td>
          <td class="p-3">{{ equip.hours_mileage }}</td>
          <td class="p-3">{{ equip.fuel_type }}</td>
          <td class="p-3">{{ equip.gross_weight }}</td>
          <td class="p-3">{{ 'Yes' if equip.requires_operator else 'No' }}</td>
          <td class="p-3">{{ equip.last_maintenance }}</td>
          <td class="p-3">{{ equip.status }}</td>
          <td class="p-3">
            <a href="/equipment_detail/{{ equip.id }}" class="text-orange-500 hover:underline">View/Edit</a>
          </td>
          {% if can_edit %}
          <td class="p-3">
            <form method="POST" onsubmit="return confirm('Are you sure?');">
              <input type="hidden" name="equip_id" value="{{ equip.id }}">
              <button type="submit" name="delete_equipment" class="bg-red-500 text-white px-3 py-1 rounded-lg hover:bg-red-600">Delete</button>
            </form>
          </td>
          {% endif %}
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>
{% endblock %}